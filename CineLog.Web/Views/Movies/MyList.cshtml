@using CineLog.Core.Entities
@model List<UserMovie>

@{
	ViewData["Title"] = "Arşivim";
}

<div class="container mt-4 fade-in">

	<div class="glass-panel p-4 rounded-4 mb-5 d-flex flex-column flex-md-row justify-content-between align-items-center">
		<div class="d-flex align-items-center mb-3 mb-md-0">
			<div class="bg-warning bg-opacity-10 text-warning p-3 rounded-circle me-3">
				<i class="bi bi-collection-play-fill fs-3"></i>
			</div>
			<div>
				<h2 class="fw-bold text-white mb-0">İzleme Listem</h2>
				<p class="text-white-50 mb-0 small">Kişisel film koleksiyonunuz</p>
			</div>
		</div>

		<div class="text-end">
			<span class="badge bg-primary rounded-pill px-3 py-2 fs-6 shadow-sm">
				<i class="bi bi-film me-2"></i>Toplam: <strong>@Model.Count</strong>
			</span>
		</div>
	</div>
	@if (Model.Count == 0)
	{
		<div class="text-center py-5">
			<div class="glass-panel d-inline-block p-5 rounded-circle mb-4" style="width: 200px; height: 200px; display: flex; align-items: center; justify-content: center;">
				<i class="bi bi-camera-reels display-1 text-secondary opacity-50"></i>
			</div>
			<h3 class="text-white fw-bold">Listeniz Henüz Boş</h3>
			<p class="text-muted fs-5 mb-4">Henüz arşivinize hiç film eklemediniz.</p>
			<a asp-action="Index" class="btn btn-warning btn-lg rounded-pill px-5 fw-bold shadow-lg hover-scale">
				<i class="bi bi-search me-2"></i> Film Keşfet
			</a>
		</div>
	}
	else
	{
		<div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-4">
			@foreach (var item in Model)
			{
				<div class="col">
					<div class="card h-100 movie-card rounded-4">
						<div class="movie-poster-container bg-dark position-relative">
							<span class="position-absolute top-0 start-0 m-2 badge bg-dark bg-opacity-75 backdrop-blur rounded-pill border border-secondary border-opacity-25 z-2">
								<i class="bi bi-calendar-check me-1 text-info"></i> @item.AddedDate.ToString("dd.MM.yyyy")
							</span>

							@if (item.Movie.PosterUrl != "N/A")
							{
								<img src="@item.Movie.PosterUrl" class="movie-poster" alt="@item.Movie.Title">
							}
							else
							{
								<div class="d-flex flex-column align-items-center justify-content-center h-100 text-secondary">
									<i class="bi bi-image-fill fs-1 mb-2"></i>
									<span>Görsel Yok</span>
								</div>
							}
							<span class="position-absolute bottom-0 end-0 m-2 badge bg-primary bg-opacity-90 rounded-pill shadow-sm">
								@item.Movie.Genre.Split(',')[0]
							</span>
						</div>
						<div class="card-body d-flex flex-column">
							<h5 class="card-title text-white fw-bold text-truncate mb-1" title="@item.Movie.Title">
								@item.Movie.Title
							</h5>

							<div class="d-flex justify-content-between align-items-center mb-3">
								<span class="text-muted small">
									<i class="bi bi-camera-video me-1"></i> @item.Movie.Year
								</span>
								<span class="text-warning small fw-bold">
									<i class="bi bi-star-fill me-1"></i> @item.Movie.ImdbRating
								</span>
							</div>
							<div class="mt-auto d-flex gap-2">
								<a asp-action="Details" asp-route-id="@item.Movie.ImdbId"
								   class="btn btn-outline-dark flex-grow-1 rounded-3 border-opacity-25 hover-warning btn-sm">
									<i class="bi bi-play-circle"></i> İncele
								</a>
								<form asp-controller="Movies" asp-action="RemoveFromList" method="post" class="flex-grow-1">
									<input type="hidden" name="imdbId" value="@item.Movie.ImdbId" />

									<button type="submit" class="btn btn-outline-danger w-100 rounded-3 border-opacity-25 btn-sm"
											onclick="return confirm('@item.Movie.Title filmini silmek istediğine emin misin?');">
										<i class="bi bi-trash"></i> Sil
									</button>
								</form>
							</div>

						</div>
					</div>
				</div>
			}
		</div>
	}
</div>